<?xml version="1.0" encoding="UTF-8"?>
<tdml:testSuite suiteName="Syslog"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xmlns:dfdl="http://www.ogf.org/dfdl/dfdl-1.0/"
  xmlns:tdml="http://www.ibm.com/xmlns/dfdl/testData"
  xmlns:daf="urn:ogf:dfdl:2013:imp:opensource.ncsa.illinois.edu:2012:ext"
  xmlns:sl="urn:syslog:1.0"
  defaultRoundTrip="true"
  defaultValidation="on">

  <tdml:parserTestCase name="syslog_example_01" root="Syslog"
    model="com/tresys/syslog/xsd/syslog.dfdl.xsd" description="example from rfc-5424"
    roundTrip='false'>
    <tdml:document>
      <tdml:documentPart type="text" replaceDFDLEntities="true"><![CDATA[<34>1 2003-10-11T22:14:15.003Z mymachine.example.com su - ID47 - %#xEF;%#xBB;%#xBF;'su root' failed for lonvick on /dev/pts/8]]></tdml:documentPart>
    </tdml:document>
    <tdml:infoset>
      <tdml:dfdlInfoset>
        <sl:Syslog>
          <Header>
            <Facility>4</Facility>
            <Severity>2</Severity>
            <Version>1</Version>
            <TimestampNano>2003-10-11T22:14:15.003000+00:00</TimestampNano>
            <Hostname>mymachine.example.com</Hostname>
            <AppName>su</AppName>
            <ProcID xsi:nil="true" />
            <MsgID>ID47</MsgID>
          </Header>
          <NoStructuredData />
          <Message>
            <UTF8>'su root' failed for lonvick on /dev/pts/8</UTF8>
          </Message>
        </sl:Syslog>
      </tdml:dfdlInfoset>
    </tdml:infoset>
  </tdml:parserTestCase>

  <tdml:parserTestCase name="syslog_example_02" root="Syslog"
    model="com/tresys/syslog/xsd/syslog.dfdl.xsd" description="example from rfc-5424"
    roundTrip='false'>
    <tdml:document>
      <tdml:documentPart type="text" replaceDFDLEntities="true"><![CDATA[<165>1 2003-08-24T05:14:15.000003-07:00 192.0.2.1 myproc 8710 - - %% It's time to make the do-nuts.]]></tdml:documentPart>
    </tdml:document>
    <tdml:infoset>
      <tdml:dfdlInfoset>
        <sl:Syslog>
          <Header>
            <Facility>20</Facility>
            <Severity>5</Severity>
            <Version>1</Version>
            <TimestampNano>2003-08-24T05:14:15.000000-07:00</TimestampNano>
            <Hostname>192.0.2.1</Hostname>
            <AppName>myproc</AppName>
            <ProcID>8710</ProcID>
            <MsgID xsi:nil="true" />
          </Header>
          <NoStructuredData />
          <Message>
            <Any>%% It's time to make the do-nuts.</Any>
          </Message>
        </sl:Syslog>
      </tdml:dfdlInfoset>
    </tdml:infoset>
  </tdml:parserTestCase>

  <tdml:parserTestCase name="syslog_example_03" root="Syslog"
    model="com/tresys/syslog/xsd/syslog.dfdl.xsd" description="example from rfc-5424"
    roundTrip='false'>
    <tdml:document>
      <tdml:documentPart type="text" replaceDFDLEntities="true"><![CDATA[<165>1 2003-10-11T22:14:15.003Z mymachine.example.com evntslog - ID47 [exampleSDID@32473 iut="3" eventSource="Application" eventID="1011"] %#xEF;%#xBB;%#xBF;An application event log entry...]]></tdml:documentPart>
    </tdml:document>
    <tdml:infoset>
      <tdml:dfdlInfoset>
        <sl:Syslog>
          <Header>
            <Facility>20</Facility>
            <Severity>5</Severity>
            <Version>1</Version>
            <TimestampNano>2003-10-11T22:14:15.003000+00:00</TimestampNano>
            <Hostname>mymachine.example.com</Hostname>
            <AppName>evntslog</AppName>
            <ProcID xsi:nil="true" />
            <MsgID>ID47</MsgID>
          </Header>
          <StructuredData>
            <SDElement>
              <SDID>exampleSDID@32473</SDID>
              <SDParam>
                <ParamName>iut</ParamName>
                <ParamValue>3</ParamValue>
              </SDParam>
              <SDParam>
                <ParamName>eventSource</ParamName>
                <ParamValue>Application</ParamValue>
              </SDParam>
              <SDParam>
                <ParamName>eventID</ParamName>
                <ParamValue>1011</ParamValue>
              </SDParam>
            </SDElement>
          </StructuredData>
          <Message>
            <UTF8>An application event log entry...</UTF8>
          </Message>
        </sl:Syslog>
      </tdml:dfdlInfoset>
    </tdml:infoset>
  </tdml:parserTestCase>

  <tdml:parserTestCase name="syslog_example_04" root="Syslog"
    model="com/tresys/syslog/xsd/syslog.dfdl.xsd" description="example from rfc-5424"
    roundTrip='false'>
    <tdml:document>
      <tdml:documentPart type="text" replaceDFDLEntities="true"><![CDATA[<165>1 2003-10-11T22:14:15.003Z mymachine.example.com evntslog - ID47 [exampleSDID@32473 iut="3" eventSource="Application" eventID="1011"][examplePriority@32473]]]></tdml:documentPart>
    </tdml:document>
    <tdml:infoset>
      <tdml:dfdlInfoset>
        <sl:Syslog>
          <Header>
            <Facility>20</Facility>
            <Severity>5</Severity>
            <Version>1</Version>
            <TimestampNano>2003-10-11T22:14:15.003000+00:00</TimestampNano>
            <Hostname>mymachine.example.com</Hostname>
            <AppName>evntslog</AppName>
            <ProcID xsi:nil="true" />
            <MsgID>ID47</MsgID>
          </Header>
          <StructuredData>
            <SDElement>
              <SDID>exampleSDID@32473</SDID>
              <SDParam>
                <ParamName>iut</ParamName>
                <ParamValue>3</ParamValue>
              </SDParam>
              <SDParam>
                <ParamName>eventSource</ParamName>
                <ParamValue>Application</ParamValue>
              </SDParam>
              <SDParam>
                <ParamName>eventID</ParamName>
                <ParamValue>1011</ParamValue>
              </SDParam>
            </SDElement>
            <SDElement>
              <SDID>examplePriority@32473</SDID>
            </SDElement>
          </StructuredData>
        </sl:Syslog>
      </tdml:dfdlInfoset>
    </tdml:infoset>
  </tdml:parserTestCase>

  <tdml:parserTestCase name="syslog_example_01_no_nano" root="Syslog"
    model="com/tresys/syslog/xsd/syslog.dfdl.xsd" description="example from rfc-5424"
    roundTrip='false'>
    <tdml:document>
      <tdml:documentPart type="text" replaceDFDLEntities="true"><![CDATA[<34>1 2003-10-11T22:14:15Z mymachine.example.com su - ID47 - %#xEF;%#xBB;%#xBF;'su root' failed for lonvick on /dev/pts/8]]></tdml:documentPart>
    </tdml:document>
    <tdml:infoset>
      <tdml:dfdlInfoset>
        <sl:Syslog>
          <Header>
            <Facility>4</Facility>
            <Severity>2</Severity>
            <Version>1</Version>
            <Timestamp>2003-10-11T22:14:15.000000+00:00</Timestamp>
            <Hostname>mymachine.example.com</Hostname>
            <AppName>su</AppName>
            <ProcID xsi:nil="true" />
            <MsgID>ID47</MsgID>
          </Header>
          <NoStructuredData />
          <Message>
            <UTF8>'su root' failed for lonvick on /dev/pts/8</UTF8>
          </Message>
        </sl:Syslog>
      </tdml:dfdlInfoset>
    </tdml:infoset>
  </tdml:parserTestCase>

</tdml:testSuite>
